@using Common.Dto
@using Common.Enums.Entities
@model ICatalogPublishable
@{
	CatalogableTypes optionType;

	if (Model is IOptionCategoryDto)
	{
		optionType = CatalogableTypes.Category;
	}
	else    //need a default case
	{
		optionType = CatalogableTypes.Option;
	}
}

<div class="dd" style="margin-top: 10px; width: 100%;">
	<div class="dd-row">
		<div class="color-bar"></div>

		<div class="dd-cell-nostyle">
			<div class="dd">
				<div class="dd-row">
					@if (Model is IServiceDto) /*deal with the title */
					{
						<div class="dd-cell-base" style="width: 90%">
							<div class="subtitle-div">
								@Html.ActionLink(Model.Name, "Details", new { serviceId = 1, type = optionType, id = Model.Id })
							</div>
						</div>
					}
					else if (Model is IOffering)
					{
						<div class="dd-cell-base" style="width: 90%">
							<div class="title-div">
								@Html.ActionLink(Model.Name, "Details", new { serviceId = 1, type = optionType, id = Model.Id })
							</div>
						</div>
					}

					@if (Model is IRequestable)
					{
						<div class="dd-cell-nostyle" style="vertical-align: top; text-align: right; width: 10%;">
							<a href="@Url.Action("BeginOptionRequest", "ServiceRequest", new {id = Model.Id})" , class="btn btn-primary">Request <i class="fa fa-chevron-right" aria-hidden="true"></i></a>
						</div>
					}
				</div>
				<div class="dd-row">
					@if (optionType == CatalogableTypes.Category)
					{
						var category = (IOptionCategoryDto)Model;

						<div class="dd-row">
							<div class="dd-cell">@Html.Raw(category.BusinessValue)</div>
						</div>

						if (category.ServiceOptions != null && category.ServiceOptions.Any())
						{
							<div class="dd-row">
								<div class="dd-cell" style="position: relative;">

									<input id="drop-checkbox@(Model.Id)" type="checkbox" class="drop-checkbox">
									<label for="drop-checkbox@(Model.Id)" id="example" class="drop-text" data-toggle="collapse" data-target="#category@(Model.Id)">See options</label>

									<div class="collapse drop-well" id="category@(Model.Id)">
										@foreach (var item in category.ServiceOptions)
										{
											<div class="flex-container-col">
												<div class="subsubtitle-div" style="padding-right: 20px;">@item.Name</div>
												<div style="padding-right: 20px;">@Html.Raw(item.BusinessValue)</div>
											</div>
										}
									</div>
								</div>
							</div>
						}
					}
					else if (optionType == CatalogableTypes.Option)
					{
						IServiceOptionDto opt = (IServiceOptionDto)Model;
						<div class="dd-row">
							<div class="dd-cell">@Html.Raw(opt.BusinessValue)</div>
						</div>
					}

				</div>
			</div>
		</div>
	</div>
</div>
