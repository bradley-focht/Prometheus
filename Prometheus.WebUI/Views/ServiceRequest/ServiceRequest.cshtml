@using Prometheus.WebUI.Models.ServiceRequest
@model ServiceRequestModel
@{
    ViewBag.Title = "Service Request";
    Layout = "~/Views/Shared/_Layout.cshtml";
    ViewBag.Links = new List<KeyValuePair<string, string>>
    {
        new KeyValuePair<string, string>("Home", "Home"),
        new KeyValuePair<string, string>("Service Request", "#")
    };

    var submitAction = Model.CurrentIndex < 0 ? "SaveInfo" : "SaveForm";            //post operation to perform
}



@using (Html.BeginForm(submitAction, "ServiceRequest", FormMethod.Post))
{
    <input type="hidden" name="InitialOptionId" value="@Model.InitialOptionId" />
    <input type="hidden" name="PackageId" value="@Model.Package.Id" />
    <input type="hidden" name="Id" value="@Model.ServiceRequestId" />
    <input type="hidden" name="Index" value="@Model.CurrentIndex" />

    <div class="panel panel-default flex-container-row make-space-bottom">
        <div class="dd full-width">
            <div class="dd-row">
                <div class="dt-cell">Service Request</div>
                <div class="dd-cell-multicol">@Model.Package.Name</div>
                <div class="dt-cell">Status</div>
                <div class="dd-cell-multicol"></div>
            </div>
            <div class="dd-row">
                <div class="dt-cell"></div>
                <div class="dd-cell-multicol"></div>
                @if (Model.ServiceRequestId > 0)
                {
                    <div class="dt-cell">Service Request Id</div>
                    <div class="dd-cell-multicol">@Model.ServiceRequestId</div>
                }
            </div>
        </div>
    </div>

    @Html.Partial("PartialViews/ServiceRequestNavigation", new ServiceRequestNavigationModel { SelectedIndex = Model.CurrentIndex, Titles = Model.Package.ServiceOptionCategories })

    <div class="panel-div full-width">
        @if (Model.CurrentIndex < 0)
        {
            @Html.Partial("PartialViews/ServiceRequestInfo", Model)
        }
        else
        {
            @Html.Partial("PartialViews/ServiceRequestForm", Model.OptionCategory)
        }



    </div>
        <div class="flex-container-col">
            <div class="make-space-bottom" style="display: flex; justify-content: flex-end; margin-right: 40px;">

                @if (Model.CurrentIndex >= 0)
                {
                    <div class="make-space-right">
                        <button name="submit" value="@(Model.CurrentIndex - 1)" class="btn btn-default">Back</button>
                    </div>
                }

                @if (Model.CurrentIndex != (Model.Package.ServiceOptionCategories.Count() -1 ))
                {
                    <div>
                        <button name="submit" value="@(Model.CurrentIndex + 1)" class="btn btn-default">Next</button>
                    </div>
                }
            </div>

            <div class="panel-footer">
                <div class="float-right-div">
                    @Html.ActionLink("Cancel Request", "CancelRequest", new { id = Model.ServiceRequestId }, new { @class = "btn btn-danger" })
                    @if (Model.ServiceRequestId > 0)
                    {
                        <input type="submit" value="Submit Request" name="SRSubmit" class="btn btn-primary" />
                    }
                </div>
            </div>
        </div>

}

